"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[634],{6810:function(n,e,t){t.d(e,{Bw:function(){return c},hk:function(){return s},jx:function(){return l},qk:function(){return u}});var o=t(1933),a=t(5234),i=t(4936),r="getChannel",c=function(n){var e=n.page,t=n.limit,i=n.searchText,c=n.sort,l=(0,a.bK)(),s=(0,o.useQuery)({queryKey:[r,"".concat(r,"-").concat(i||""),c],queryFn:function(){return l.get("/channels?page=".concat(e,"&limit=").concat(t).concat(i?"&searchText=".concat(i):"").concat(null!==c&&void 0!==c&&c.sortOrder?"?sort[".concat(String(c.sortKey),"]=").concat(String(c.sortOrder.slice(0,-3))):"")).then((function(n){return n.data}))}});return{data:s.data,isLoading:s.isLoading,refetch:s.refetch,isRefetching:s.isRefetching}},l=function(){var n=(0,i.f)().onError,e=(0,o.useQueryClient)(),t=(0,a.bK)();return(0,o.useMutation)((function(n){return t.post("/channels",n)}),{onSuccess:function(){e.invalidateQueries(r)},onError:function(e){n(e)}})},s=function(){var n=(0,i.f)().onError,e=(0,o.useQueryClient)(),t=(0,a.bK)();return(0,o.useMutation)((function(n){var e=n.channelForm,o=n.id;return t.put("/channels/".concat(o),e)}),{onSuccess:function(){e.invalidateQueries(r)},onError:function(e){n(e)}})},u=function(){var n=(0,i.f)().onError,e=(0,o.useQueryClient)(),t=(0,a.bK)();return(0,o.useMutation)((function(n){var e=n.id,o=n.active;return t.put("/channels/".concat(e,"?active=").concat(String(o)))}),{onSuccess:function(){e.invalidateQueries(r)},onError:function(e){n(e)}})}},1454:function(n,e,t){t(2791);var o=t(6038),a=t(7309),i=t(184);e.Z=function(n){var e=n.haveEdit,t=n.disable,r=n.onCloseModal;return e?(0,i.jsx)(o.Z,{placement:"bottom",arrowPointAtCenter:!0,title:"All of unsaved data will be lose if you close this.",onConfirm:r,okText:"Leave",okButtonProps:{type:"default",danger:!0},cancelText:"Continue",children:(0,i.jsx)(a.Z,{disabled:t,children:"Cancel"})}):(0,i.jsx)(a.Z,{disabled:t,onClick:r,children:"Cancel"})}},1569:function(n,e,t){var o=t(7548),a=t(6106),i=t(914),r=(t(2791),t(184));e.Z=function(n){var e=n.title,t=n.description,c=n.icon,l=n.showModal,s=n.modalLoading,u=n.okText,d=void 0===u?"Confirm":u,f=n.okType,h=void 0===f?"primary":f,v=n.cancelText,m=void 0===v?"Cancel":v,Z=n.onOk,g=n.onCancel;return(0,r.jsx)(o.Z,{title:(0,r.jsxs)(a.Z,{align:"middle",children:[c&&(0,r.jsx)(i.Z,{span:2,children:c}),(0,r.jsx)(i.Z,{span:c?22:24,children:e})]}),maskClosable:!1,closable:!1,okText:d,okType:h,cancelText:m,onOk:Z,onCancel:g,visible:l,confirmLoading:s,getContainer:!1,children:t})}},4936:function(n,e,t){t.d(e,{f:function(){return c}});var o=t(9439),a=t(6910),i=t(3294),r=(0,a.cn)({key:"ErrorMessage",default:""}),c=function(){var n=(0,a.FV)(r),e=(0,o.Z)(n,2),t=e[0],c=e[1];return{errMsg:t,setErrMsgState:c,clearErrMsg:function(){c("")},onError:function(n){var e=JSON.parse(JSON.stringify(n)),t=n;try{var o,a=t.response.data,r=a.error_code,l=a.message,s=a.debug_message;if(r!==i.jK.UNAUTHORIZED)c("".concat(null===e||void 0===e?void 0:e.message,": ").concat(null!==(o=null!==s&&void 0!==s?s:r)&&void 0!==o?o:l))}catch(u){c("Error: ".concat(String(n)))}}}}},9634:function(n,e,t){t.r(e),t.d(e,{default:function(){return U}});var o,a,i,r,c,l,s=t(9439),u=t(168),d=t(2791),f=t(6031),h=t(521),v=t(9389),m=t(6106),Z=t(914),g=t(3099),p=t(7083),C=t(1046),x=t(5796),b=t(9286),y=t(6810),S=t(3294),j=t(1413),k=t(5581),w=t(4392),E=t(9421),M=t(5527),T=t(184),O=function(n){var e=n.data,t=n.canEdit,o=n.onEdit,a=n.canSetStatus,i=n.onSetStatus,r=n.onChangeSort,c=(0,d.useMemo)((function(){var n;return null===e||void 0===e||null===(n=e.items)||void 0===n?void 0:n.map((function(n){return(0,j.Z)({},n)}))}),[e]),l=[{title:"Channel name",key:"name",width:"90%",dataIndex:"name",sorter:function(n,e){return n.name.localeCompare(e.name)}},{title:"Status",key:"status",render:function(n){return(0,T.jsx)(k.Z,{defaultChecked:null===n||void 0===n?void 0:n.active,checked:null===n||void 0===n?void 0:n.active,onClick:function(e,t){t.stopPropagation(),i(n)}})},width:"10%"}],s=[{title:"Channel name",key:"name",width:"90%",dataIndex:"name",sorter:function(n,e){return n.name.localeCompare(e.name)}},{title:"Status",key:"status",render:function(n){return(0,T.jsx)(M.Z,{twoToneColor:n.active?"#52c41a":"#dddddd"})},width:"10%"}];return(0,T.jsx)(w.Z,{size:"small",locale:{emptyText:(0,T.jsx)(E.Z,{image:E.Z.PRESENTED_IMAGE_SIMPLE})},dataSource:null!==c&&void 0!==c?c:[],columns:a?l:s,scroll:{y:"calc(75vh - 4rem)"},pagination:{defaultPageSize:S.L8,pageSizeOptions:S.TJ},onRow:function(n){return{onClick:function(){t&&o(n)}}},onChange:function(n,e,t){var o,a=t;r({sortKey:String(a.columnKey),sortOrder:null!==(o=a.order)&&void 0!==o?o:void 0})}})},N=t(785),L=t(3272),P=t(7548),I=t(1454),z=t(4936),K=(0,f.ZP)(Z.Z)(o||(o=(0,u.Z)(["\n  text-align: center;\n"]))),_=(0,f.ZP)(N.Z)(a||(a=(0,u.Z)(["\n  text-align: center;\n  margin-top: 20px;\n"]))),F=function(n){var e,t=n.data,o=n.showModal,a=n.modalLoading,i=n.onSubmit,r=n.onCloseModal,c=n.onLoadingModal,l=(0,d.useState)(!1),u=(0,s.Z)(l,2),f=u[0],h=u[1],p=(0,z.f)(),x=p.errMsg,b=p.clearErrMsg,y=L.Z.useForm(),S=(0,s.Z)(y,1)[0],k=Boolean(null!==(e=null===t||void 0===t?void 0:t.id)&&void 0!==e&&e),w=k?(0,j.Z)({},t):{};return(0,d.useEffect)((function(){S.resetFields()}),[]),(0,T.jsxs)(P.Z,{title:"".concat(k?"Update":"Create"," Channel"),width:"50%",maskClosable:!1,closable:!1,footer:null,visible:o,confirmLoading:a,getContainer:!1,children:[(0,T.jsx)(m.Z,{children:(0,T.jsx)(Z.Z,{span:24,children:(0,T.jsx)(L.Z,{form:S,onFinish:function(){c(!0),S.validateFields().then((function(n){i(n,null===t||void 0===t?void 0:t.id)})).catch((function(){c(!1)}))},onFieldsChange:function(){h(!0)},name:"definition-form",labelCol:{span:6},wrapperCol:{span:18},initialValues:w,children:(0,T.jsx)(L.Z.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Channel name is required.",whitespace:!0}],children:(0,T.jsx)(v.Z,{placeholder:"Channel name"})})})})}),(0,T.jsx)(m.Z,{justify:"center",children:(0,T.jsx)(K,{children:(0,T.jsxs)(g.Z,{size:"middle",children:[(0,T.jsx)(C.Z,{type:k?"primary":"success",onClick:function(){return S.submit()},loading:a,children:k?"Update":"Create"}),(0,T.jsx)(I.Z,{onCloseModal:r,disable:a,haveEdit:f})]})})}),x&&(0,T.jsx)(_,{message:x,type:"error",showIcon:!0,closable:!0,onClose:function(){b()}})]})},R=t(1569),q=t(727),D=(h.Z.Title,v.Z.Search),Q=(0,f.ZP)(m.Z)(i||(i=(0,u.Z)(["\n  padding-bottom: 15px;\n  width: 100%;\n  justify-content: space-between;\n"]))),A=(0,f.ZP)(x.Z)(r||(r=(0,u.Z)(["\n  font-size: 22px;\n  color: #fbb437;\n"]))),B=(0,f.ZP)(Z.Z)(c||(c=(0,u.Z)(["\n  text-align: right;\n"]))),H=(0,f.ZP)(D)(l||(l=(0,u.Z)(["\n  width: 250px;\n"]))),U=function(){var n=(0,q.a)().accessPermission,e=(null===n||void 0===n?void 0:n.create_channels)||!1,t=(null===n||void 0===n?void 0:n.edit_channels)||!1,o=(null===n||void 0===n?void 0:n.set_channel_status)||!1,a=(0,d.useState)(!1),i=(0,s.Z)(a,2),r=i[0],c=i[1],l=(0,d.useState)(!1),u=(0,s.Z)(l,2),f=u[0],h=u[1],v=(0,d.useState)(!1),m=(0,s.Z)(v,2),x=m[0],j=m[1],k=(0,d.useState)(!1),w=(0,s.Z)(k,2),E=w[0],M=w[1],N=(0,z.f)(),L=(N.errMsg,N.clearErrMsg),P=(0,d.useState)(),I=(0,s.Z)(P,2),K=I[0],_=I[1],D=(0,d.useState)(),U=(0,s.Z)(D,2),V=U[0],J=U[1],G=(0,d.useState)(),W=(0,s.Z)(G,2),X=W[0],Y=W[1],$=(0,y.jx)(),nn=(0,y.hk)(),en=(0,y.qk)(),tn=(0,y.Bw)({page:S.q5,limit:S.VZ,searchText:V,sort:X}),on=tn.data,an=tn.isLoading,rn=tn.isRefetching,cn=function(n){h(n)},ln=function(n){c(n),L()},sn=function(n){j(n)},un=function(n){var e;en.mutate({id:n.id,active:null===(e=!n.active)||void 0===e||e},{onSuccess:function(n){sn(!1),dn(!1)},onError:function(){dn(!1)}})},dn=function(n){M(n)};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(Z.Z,{children:(0,T.jsxs)(Q,{justify:"start",children:[(0,T.jsx)(Z.Z,{span:12,children:(0,T.jsx)(g.Z,{children:e&&(0,T.jsx)(C.Z,{onClick:function(){_(void 0),ln(!0)},type:"success",icon:(0,T.jsx)(b.Z,{}),children:"Create new"})})}),r&&(0,T.jsx)(F,{data:K,showModal:r,modalLoading:f,onSubmit:function(n,e){e?function(n,e){n&&nn.mutate({channelForm:n,id:null!==e&&void 0!==e?e:""},{onSuccess:function(){ln(!1),cn(!1)},onError:function(){cn(!1)}})}(n,e):function(n){n&&$.mutate(n,{onSuccess:function(){ln(!1),cn(!1)},onError:function(){cn(!1)}})}(n)},onCloseModal:function(){return ln(!1)},onLoadingModal:function(n){return cn(n)}}),x&&(0,T.jsx)(R.Z,{title:'Are you sure you would like to disable the "'.concat(null!==K&&void 0!==K&&K.name?null===K||void 0===K?void 0:K.name:"",'" channel ?'),description:"Disable ".concat(null!==K&&void 0!==K&&K.name?null===K||void 0===K?void 0:K.name:""," channel"),icon:(0,T.jsx)(A,{}),okText:"Disable",cancelText:"Cancel",showModal:x,modalLoading:E,okType:"danger",onOk:function(){null!==K&&void 0!==K&&K.id&&(dn(!0),un(K))},onCancel:function(){sn(!1)}}),(0,T.jsx)(g.Z,{children:(0,T.jsx)(B,{span:16,children:(0,T.jsx)(H,{placeholder:"Search",allowClear:!0,loading:rn,onSearch:function(n){J(n)}})})})]})}),(0,T.jsx)(p.Z,{spinning:an||rn||E,children:(0,T.jsx)(O,{data:on,canEdit:t,canSetStatus:o,onEdit:function(n){_(n),ln(!0)},onSetStatus:function(n){n.active?(_(n),sn(!0)):(_(n),dn(!0),un(n))},onChangeSort:Y})})]})}},5527:function(n,e,t){t.d(e,{Z:function(){return l}});var o=t(1413),a=t(2791),i={icon:function(n,e){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:n}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z",fill:e}},{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z",fill:n}}]}},name:"check-circle",theme:"twotone"},r=t(4291),c=function(n,e){return a.createElement(r.Z,(0,o.Z)((0,o.Z)({},n),{},{ref:e,icon:i}))};c.displayName="CheckCircleTwoTone";var l=a.forwardRef(c)},5581:function(n,e,t){t.d(e,{Z:function(){return b}});var o=t(7462),a=t(4942),i=t(2791),r=t(9439),c=t(4925),l=t(1694),s=t.n(l),u=t(5179),d=t(1354),f=i.forwardRef((function(n,e){var t,o=n.prefixCls,l=void 0===o?"rc-switch":o,f=n.className,h=n.checked,v=n.defaultChecked,m=n.disabled,Z=n.loadingIcon,g=n.checkedChildren,p=n.unCheckedChildren,C=n.onClick,x=n.onChange,b=n.onKeyDown,y=(0,c.Z)(n,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),S=(0,u.Z)(!1,{value:h,defaultValue:v}),j=(0,r.Z)(S,2),k=j[0],w=j[1];function E(n,e){var t=k;return m||(w(t=n),null===x||void 0===x||x(t,e)),t}var M=s()(l,f,(t={},(0,a.Z)(t,"".concat(l,"-checked"),k),(0,a.Z)(t,"".concat(l,"-disabled"),m),t));return i.createElement("button",Object.assign({},y,{type:"button",role:"switch","aria-checked":k,disabled:m,className:M,ref:e,onKeyDown:function(n){n.which===d.Z.LEFT?E(!1,n):n.which===d.Z.RIGHT&&E(!0,n),null===b||void 0===b||b(n)},onClick:function(n){var e=E(!k,n);null===C||void 0===C||C(e,n)}}),Z,i.createElement("span",{className:"".concat(l,"-inner")},k?g:p))}));f.displayName="Switch";var h=f,v=t(7106),m=t(2833),Z=t(1929),g=t(1815),p=t(9125),C=function(n,e){var t={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(null!=n&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(n);a<o.length;a++)e.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(n,o[a])&&(t[o[a]]=n[o[a]])}return t},x=i.forwardRef((function(n,e){var t,r=n.prefixCls,c=n.size,l=n.disabled,u=n.loading,d=n.className,f=void 0===d?"":d,x=C(n,["prefixCls","size","disabled","loading","className"]),b=i.useContext(Z.E_),y=b.getPrefixCls,S=b.direction,j=i.useContext(g.Z),k=i.useContext(p.Z),w=l||k||u,E=y("switch",r),M=i.createElement("div",{className:"".concat(E,"-handle")},u&&i.createElement(v.Z,{className:"".concat(E,"-loading-icon")})),T=s()((t={},(0,a.Z)(t,"".concat(E,"-small"),"small"===(c||j)),(0,a.Z)(t,"".concat(E,"-loading"),u),(0,a.Z)(t,"".concat(E,"-rtl"),"rtl"===S),t),f);return i.createElement(m.Z,{insertExtraNode:!0},i.createElement(h,(0,o.Z)({},x,{prefixCls:E,className:T,disabled:w,ref:e,loadingIcon:M})))}));x.__ANT_SWITCH=!0,x.displayName="Switch";var b=x}}]);
//# sourceMappingURL=634.a7dd0e63.chunk.js.map