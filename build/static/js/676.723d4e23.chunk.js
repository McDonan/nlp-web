"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[676],{1454:function(n,e,t){t(2791);var o=t(6038),i=t(7309),r=t(184);e.Z=function(n){var e=n.haveEdit,t=n.disable,a=n.onCloseModal;return e?(0,r.jsx)(o.Z,{placement:"bottom",arrowPointAtCenter:!0,title:"All of unsaved data will be lose if you close this.",onConfirm:a,okText:"Leave",okButtonProps:{type:"default",danger:!0},cancelText:"Continue",children:(0,r.jsx)(i.Z,{disabled:t,children:"Cancel"})}):(0,r.jsx)(i.Z,{disabled:t,onClick:a,children:"Cancel"})}},1569:function(n,e,t){var o=t(7548),i=t(6106),r=t(914),a=(t(2791),t(184));e.Z=function(n){var e=n.title,t=n.description,c=n.icon,l=n.showModal,d=n.modalLoading,s=n.okText,u=void 0===s?"Confirm":s,f=n.okType,g=void 0===f?"primary":f,h=n.cancelText,v=void 0===h?"Cancel":h,Z=n.onOk,x=n.onCancel;return(0,a.jsx)(o.Z,{title:(0,a.jsxs)(i.Z,{align:"middle",children:[c&&(0,a.jsx)(r.Z,{span:2,children:c}),(0,a.jsx)(r.Z,{span:c?22:24,children:e})]}),maskClosable:!1,closable:!1,okText:u,okType:g,cancelText:v,onOk:Z,onCancel:x,visible:l,confirmLoading:d,getContainer:!1,children:t})}},8478:function(n,e,t){var o,i,r,a,c=t(168),l=(t(2791),t(6031)),d=t(7305),s=t(521),u=t(9228),f=t(7083),g=t(6106),h=t(914),v=t(3099),Z=t(1046),x=t(3876),m=t(3685),p=t(2864),j=t(3294),b=t(184),S=(0,l.ZP)(d.Z)(o||(o=(0,c.Z)(["\n  background: ",";\n  width: 100%;\n  height: 100%;\n  color: #ffffff;\n  text-align: center;\n"])),(function(n){return n.background})),C=(0,l.ZP)(s.Z.Title)(i||(i=(0,c.Z)(["\n  color: #ffffff !important;\n"]))),w=(0,l.ZP)(x.Z)(r||(r=(0,c.Z)(["\n  font-size: 30px;\n  color: #ffffff;\n"]))),k=(0,l.ZP)(m.Z)(a||(a=(0,c.Z)(["\n  font-size: 30px;\n  color: #ffffff;\n"])));e.Z=function(n){var e=n.title,t=n.isLoading,o=n.onExport,i=function(n){o(!0,n)};return(0,b.jsx)(u.Z,{content:(0,b.jsx)(f.Z,{spinning:t,children:(0,b.jsxs)(g.Z,{gutter:[12,12],children:[(0,b.jsx)(h.Z,{span:12,children:(0,b.jsx)(S,{onClick:function(){i(j.Cx.JSON)},bordered:!1,hoverable:!0,background:"#2e72f8",children:(0,b.jsxs)(v.Z,{direction:"vertical",children:[(0,b.jsx)(w,{}),(0,b.jsx)(C,{level:5,children:"JSON"})]})})}),(0,b.jsx)(h.Z,{span:12,children:(0,b.jsx)(S,{onClick:function(){i(j.Cx.EXCEL)},bordered:!1,hoverable:!0,background:"#1d6f42",children:(0,b.jsxs)(v.Z,{direction:"vertical",children:[(0,b.jsx)(k,{}),(0,b.jsx)(C,{level:5,children:"Excel"})]})})})]})}),title:e,trigger:"click",children:(0,b.jsx)(Z.Z,{type:"info",icon:(0,b.jsx)(p.Z,{}),children:"Export All"})})}},4936:function(n,e,t){t.d(e,{f:function(){return c}});var o=t(9439),i=t(6910),r=t(3294),a=(0,i.cn)({key:"ErrorMessage",default:""}),c=function(){var n=(0,i.FV)(a),e=(0,o.Z)(n,2),t=e[0],c=e[1];return{errMsg:t,setErrMsgState:c,clearErrMsg:function(){c("")},onError:function(n){var e=JSON.parse(JSON.stringify(n)),t=n;try{var o,i=t.response.data,a=i.error_code,l=i.message,d=i.debug_message;if(a!==r.jK.UNAUTHORIZED)c("".concat(null===e||void 0===e?void 0:e.message,": ").concat(null!==(o=null!==d&&void 0!==d?d:a)&&void 0!==o?o:l))}catch(s){c("Error: ".concat(String(n)))}}}}},8676:function(n,e,t){t.r(e),t.d(e,{default:function(){return en}});var o,i,r,a,c,l,d,s=t(9439),u=t(168),f=t(2791),g=t(6031),h=t(9389),v=t(6106),Z=t(914),x=t(3099),m=t(785),p=t(7083),j=t(1046),b=t(5796),S=t(9286),C=t(1413),w=t(1933),k=t(5234),y=t(727),E=t(4936),M="getKnowledge",L=t(9593),T=t(7528),P=t(4392),O=t(9421),K=t(2622),D=t(3294),z=t(184),N=function(n){var e=n.data,t=n.canEdit,o=n.canDelete,i=n.onEdit,r=n.onDelete,a=n.onChangePage,c=n.onChangePageSize,l=n.onChangeSort,d=(0,f.useState)(0),u=(0,s.Z)(d,2),g=(u[0],u[1]),h=(0,f.useMemo)((function(){var n;return null===e||void 0===e||null===(n=e.items)||void 0===n?void 0:n.map((function(n){return(0,C.Z)({key:null===n||void 0===n?void 0:n.id},n)}))}),[e]),v=[{title:"Name",dataIndex:"name",key:"name",width:"25%",sorter:function(n,e){return n.name.localeCompare(e.name)}},{title:"Members",dataIndex:"members",key:"members",render:function(n){return(0,z.jsx)(z.Fragment,{children:n?n.map((function(n){return(0,z.jsx)(T.Z,{color:"default",children:n},n)})):""})}},{title:"Delete",key:"delete",hidden:!0,render:function(n){return(0,z.jsx)(j.Z,{type:"danger",onClick:function(e){e.stopPropagation(),r(n)},icon:(0,z.jsx)(K.Z,{}),disabled:!o})},width:"5%"}];return(0,f.useEffect)((function(){var n;g(null!==(n=null===e||void 0===e?void 0:e.meta_data.total)&&void 0!==n?n:0)}),[]),(0,z.jsx)(P.Z,{size:"small",locale:{emptyText:(0,z.jsx)(O.Z,{image:O.Z.PRESENTED_IMAGE_SIMPLE})},columns:o?v:v.filter((function(n){return!n.hidden})),dataSource:null!==h&&void 0!==h?h:[],scroll:{y:"calc(75vh - 4rem)"},pagination:{showSizeChanger:!0,showTotal:function(n){return"Total ".concat(n," items")},total:null===e||void 0===e?void 0:e.meta_data.total,defaultCurrent:1,defaultPageSize:D.L8,pageSizeOptions:D.TJ,onChange:function(n,e){a(n-1),c(e)}},onRow:function(n){return{onClick:function(){t&&i(n)}}},onChange:function(n,e,t){var o,i=t;l({sortKey:String(i.columnKey),sortOrder:null!==(o=i.order)&&void 0!==o?o:void 0})}})},R=t(3433),F=t(3272),_=t(7548),I=t(7305),A=t(521),Q=(0,g.ZP)(I.Z)(o||(o=(0,u.Z)(["\n  margin: 0px 0px 20px 30px;\n  .ant-card-body {\n    padding: 18px 24px 18px 24px;\n  }\n"]))),B=function(n){var e=function(n){var e=(0,k.bK)(),t=(0,y.a)().channel,o=t.id?t.id:"",i=(0,w.useQuery)({queryKey:"getKnowledgeMember-".concat(n),queryFn:function(){return e.get("/channel/".concat(String(o),"/knowledge/").concat(n)).then((function(n){return n.data}))}});return{data:i.data,isLoading:i.isLoading,refetch:i.refetch}}(n.id),t=e.data,o=e.isLoading;return(0,z.jsx)(p.Z,{spinning:o,children:(0,z.jsxs)(Q,{children:[(0,z.jsx)(A.Z.Title,{level:5,children:"Suggestions"}),(0,z.jsx)(P.Z,{size:"small",locale:{emptyText:(0,z.jsx)(O.Z,{image:O.Z.PRESENTED_IMAGE_SIMPLE})},columns:[{title:"Word",dataIndex:"word",key:"word"},{title:"Confidence",dataIndex:"confidence",key:"confidence"}],dataSource:t?t.suggestions:[],pagination:!1})]})})},U=t(1454),q=(0,g.ZP)(Z.Z)(i||(i=(0,u.Z)(["\n  text-align: center;\n"]))),H=(0,g.ZP)(m.Z)(r||(r=(0,u.Z)(["\n  text-align: center;\n  margin-top: 20px;\n"]))),J=function(n){var e,t=n.data,o=n.showModal,i=n.modalLoading,r=n.onSubmit,a=n.onCloseModal,c=n.onLoadingModal,l=(0,E.f)(),d=l.errMsg,u=l.onError,g=l.clearErrMsg,m=(0,f.useState)(!1),p=(0,s.Z)(m,2),b=p[0],w=p[1],k=(0,f.useState)(!1),y=(0,s.Z)(k,2),M=y[0],L=y[1],P=(0,f.useState)(""),O=(0,s.Z)(P,2),K=O[0],D=O[1],N=F.Z.useForm(),I=(0,s.Z)(N,1)[0],A=Boolean(null!==(e=null===t||void 0===t?void 0:t.id)&&void 0!==e&&e),Q=A?(0,C.Z)({},t):{},J=(0,f.useState)((null===Q||void 0===Q?void 0:Q.members)||[]),V=(0,s.Z)(J,2),Y=V[0],G=V[1],W=function(){if(K){var n=[],e=[],t=null===K||void 0===K?void 0:K.replace(/(^,)|(,$)/g,""),o=-1!==(null===t||void 0===t?void 0:t.indexOf(","))?",":-1!==(null===t||void 0===t?void 0:t.indexOf(" "))?" ":null;if(o){var i;n=null===t||void 0===t||null===(i=t.split(o))||void 0===i?void 0:i.map((function(n){return null===n||void 0===n?void 0:n.trim()})).filter((function(n){return""!==n}));var r=[].concat((0,R.Z)(Y),(0,R.Z)(n)),a=null===r||void 0===r?void 0:r.filter((function(n,e){return(null===r||void 0===r?void 0:r.indexOf(n))!=e}));if((null===a||void 0===a?void 0:a.length)>0){var c=(0,R.Z)(new Set(a)),l="is";(null===c||void 0===c?void 0:c.length)>1&&(l="are"),u("".concat(null===c||void 0===c?void 0:c.join(",")," ").concat(l," duplicated"))}e=(0,R.Z)(new Set(r)),G(e)}else-1!==(null===Y||void 0===Y?void 0:Y.indexOf(t))&&u("".concat(t," is duplicated")),e=(0,R.Z)(new Set([].concat((0,R.Z)(Y),[t]))),G(e);I.setFieldsValue({members:e})}L(!1),D("")};return(0,f.useEffect)((function(){I.resetFields()}),[]),(0,z.jsxs)(_.Z,{title:"".concat(A?"Update":"Create"," Knowledge"),width:A?"75%":"50%",maskClosable:!1,closable:!1,footer:null,visible:o,confirmLoading:i,getContainer:!1,children:[(0,z.jsxs)(v.Z,{children:[(0,z.jsx)(Z.Z,{span:A?12:24,children:(0,z.jsxs)(F.Z,{form:I,onFinish:function(){c(!0),I.validateFields().then((function(n){r(n,null===t||void 0===t?void 0:t.id)})).catch((function(){c(!1)}))},onFieldsChange:function(){w(!0)},name:"knowledge-form",labelCol:{span:6},wrapperCol:{span:18},initialValues:Q,children:[(0,z.jsx)(F.Z.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Knowledge name is required.",whitespace:!0}],children:(0,z.jsx)(h.Z,{placeholder:"Knowledge name"})}),(0,z.jsxs)(F.Z.Item,{label:"Members",name:"members",children:[null===Y||void 0===Y?void 0:Y.map((function(n){return(0,z.jsx)(T.Z,{className:"members-tag",closable:!0,onClose:function(){return function(n){var e=null===Y||void 0===Y?void 0:Y.filter((function(e){return e!==n}));G(e),I.setFieldsValue({members:e})}(n)},children:n},n)})),M&&(0,z.jsx)(h.Z,{type:"text",size:"small",className:"tag-input",value:K,onChange:function(n){D(n.currentTarget.value)},onBlur:W,onPressEnter:W}),!M&&(0,z.jsxs)(T.Z,{className:"site-tag-plus",onClick:function(){L(!0)},children:[(0,z.jsx)(S.Z,{})," New Member"]})]})]})}),A&&(0,z.jsx)(Z.Z,{span:12,children:(0,z.jsx)(B,{id:t?t.id:""})})]}),(0,z.jsx)(v.Z,{justify:"center",children:(0,z.jsx)(q,{children:(0,z.jsxs)(x.Z,{size:"middle",children:[(0,z.jsx)(j.Z,{type:A?"primary":"success",onClick:function(){return I.submit()},loading:i,children:A?"Update":"Create"}),(0,z.jsx)(U.Z,{onCloseModal:a,disable:i,haveEdit:b})]})})}),d&&(0,z.jsx)(H,{message:d,type:"error",showIcon:!0,closable:!0,onClose:g})]})},V=t(1569),Y=t(8478),G=h.Z.Search,W=(0,g.ZP)(v.Z)(a||(a=(0,u.Z)(["\n  padding-bottom: 15px;\n"]))),X=(0,g.ZP)(Z.Z)(c||(c=(0,u.Z)(["\n  text-align: right;\n"]))),$=(0,g.ZP)(G)(l||(l=(0,u.Z)(["\n  width: 250px;\n"]))),nn=(0,g.ZP)(b.Z)(d||(d=(0,u.Z)(["\n  font-size: 22px;\n  color: #fbb437;\n"]))),en=function(){var n=(0,y.a)().accessPermission,e=(null===n||void 0===n?void 0:n.create_knowledge)||!1,t=(null===n||void 0===n?void 0:n.edit_knowledge)||!1,o=(null===n||void 0===n?void 0:n.delete_knowledge)||!1,i=(null===n||void 0===n?void 0:n.search_knowledge)||!1,r=(0,f.useState)(),a=(0,s.Z)(r,2),c=a[0],l=a[1],d=(0,f.useState)(),u=(0,s.Z)(d,2),g=u[0],h=u[1],v=(0,f.useState)(0),b=(0,s.Z)(v,2),T=b[0],P=b[1],O=(0,f.useState)(D.L8),K=(0,s.Z)(O,2),R=K[0],F=K[1],_=(0,f.useState)(!1),I=(0,s.Z)(_,2),A=I[0],Q=I[1],B=(0,f.useState)(),U=(0,s.Z)(B,2),q=U[0],H=U[1],G=(0,f.useState)(),en=(0,s.Z)(G,2),tn=en[0],on=en[1],rn=(0,E.f)(),an=rn.errMsg,cn=rn.clearErrMsg,ln=function(n){var e=n.page,t=n.limit,o=n.searchText,i=n.sort,r=(0,k.bK)(),a=(0,y.a)().channel,c=a.id?a.id:"",l=(0,w.useQuery)(["".concat(M,"-").concat(c),e,t,o,i],(function(){return r.get("/channel/".concat(String(c),"/knowledge?page=").concat(String(e),"&limit=").concat(String(t)).concat(o?"&searchText=".concat(o):"").concat(null!==i&&void 0!==i&&i.sortOrder?"?sort[".concat(String(i.sortKey),"]=").concat(String(i.sortOrder.slice(0,-3))):"")).then((function(n){return n.data}))}),{keepPreviousData:!0});return{data:l.data,isLoading:l.isLoading,refetch:l.refetch,isRefetching:l.isRefetching}}({page:T,limit:R,searchText:c,sort:g}),dn=ln.data,sn=ln.isLoading,un=ln.isRefetching,fn=function(n){var e=n.type,t=n.isExport,o=n.page,i=n.limit,r=n.searchText,a=(0,E.f)().onError,c=(0,k.bK)(),l=(0,y.a)().channel,d=l.id?l.id:"",s=(0,w.useQuery)({queryKey:"exportDataSet-".concat(d),queryFn:function(){return c.get("/channel/".concat(String(d),"/knowledge/export?type=").concat(String(e),"&page=").concat(String(o),"&limit=").concat(String(i)).concat(r?"&searchText=".concat(r):""),{responseType:"blob"}).then((function(n){return n.data})).catch((function(n){return a(n)}))},enabled:Boolean(t)&&Boolean(e)});return{data:s.data,isLoading:s.isLoading,isRefetching:s.isRefetching,isError:s.isError}}({type:q,page:D.q5,limit:D.VZ,searchText:c,isExport:A}),gn=fn.data,hn=fn.isLoading,vn=fn.isRefetching,Zn=fn.isError,xn=(0,f.useState)(!1),mn=(0,s.Z)(xn,2),pn=mn[0],jn=mn[1],bn=(0,f.useState)(!1),Sn=(0,s.Z)(bn,2),Cn=Sn[0],wn=Sn[1],kn=(0,f.useState)(!1),yn=(0,s.Z)(kn,2),En=yn[0],Mn=yn[1],Ln=(0,f.useState)(!1),Tn=(0,s.Z)(Ln,2),Pn=Tn[0],On=Tn[1],Kn=(0,f.useState)(),Dn=(0,s.Z)(Kn,2),zn=Dn[0],Nn=Dn[1],Rn=function(){var n=(0,E.f)().onError,e=(0,w.useQueryClient)(),t=(0,k.bK)(),o=(0,y.a)().channel,i=o.id?o.id:"";return(0,w.useMutation)((function(n){return t.post("/channel/".concat(String(i),"/knowledge"),(0,C.Z)((0,C.Z)({},n),{},{channel_id:i}))}),{onSuccess:function(){e.invalidateQueries("".concat(M,"-").concat(i))},onError:function(e){n(e)}})}(),Fn=function(){var n=(0,E.f)().onError,e=(0,w.useQueryClient)(),t=(0,k.bK)(),o=(0,y.a)().channel,i=o.id?o.id:"";return(0,w.useMutation)((function(n){var e=n.knowledgeForm,o=n.id;return t.put("/channel/".concat(String(i),"/knowledge/").concat(o),(0,C.Z)((0,C.Z)({},e),{},{channel_id:i}))}),{onSuccess:function(){e.invalidateQueries("".concat(M,"-").concat(i))},onError:function(e){n(e)}})}(),_n=function(){var n=(0,E.f)().onError,e=(0,w.useQueryClient)(),t=(0,k.bK)(),o=(0,y.a)().channel,i=o.id?o.id:"";return(0,w.useMutation)((function(n){return t.delete("/channel/".concat(String(i),"/knowledge/").concat(n))}),{onSuccess:function(){e.invalidateQueries("".concat(M,"-").concat(i))},onError:function(e){n(e)}})}(),In=function(n){jn(n),cn()},An=function(n){wn(n)},Qn=function(n){Mn(n)},Bn=function(n){On(n)};return(0,f.useEffect)((function(){!function(){var n=!1,e=!1;A&&q&&gn&&!hn&&!vn&&!Zn&&(e=!0,n=(0,L.u)(gn,"knowledge",q)),n?Q(!1):e&&(on("".concat(D.jK.DOWNLOADFAIL)),Q(!1))}()}),[A,q,gn]),(0,z.jsxs)("div",{children:[(0,z.jsx)(Z.Z,{children:(0,z.jsxs)(W,{justify:"start",children:[(0,z.jsxs)(Z.Z,{span:8,children:[(0,z.jsxs)(x.Z,{children:[e&&(0,z.jsx)(j.Z,{onClick:function(){Nn(void 0),In(!0)},type:"success",icon:(0,z.jsx)(S.Z,{}),children:"Create"}),(0,z.jsx)(Y.Z,{title:"Export Knowledge",isLoading:hn||vn,onExport:function(n,e){!function(n,e){cn(),Q(n),H(e)}(n,e)}})]}),pn&&(0,z.jsx)(J,{data:zn,showModal:pn,modalLoading:Cn,onSubmit:function(n,e){e?function(n,e){n&&Fn.mutate({knowledgeForm:n,id:null!==e&&void 0!==e?e:""},{onSuccess:function(){In(!1),An(!1)},onError:function(){An(!1)}})}(n,e):function(n){n&&Rn.mutate(n,{onSuccess:function(){In(!1),An(!1)},onError:function(){An(!1)}})}(n)},onCloseModal:function(){return In(!1)},onLoadingModal:function(n){return An(n)}}),En&&(0,z.jsx)(V.Z,{title:'Are you sure you would like to delete the "'.concat(null!==zn&&void 0!==zn&&zn.name?null===zn||void 0===zn?void 0:zn.name:"",'" knowledge ?'),description:"All reference of this knowledge will be deleted too.",icon:(0,z.jsx)(nn,{}),okText:"Delete",cancelText:"Cancel",showModal:En,modalLoading:Pn,okType:"danger",onOk:function(){var n;null!==zn&&void 0!==zn&&zn.id&&(Bn(!0),n=null===zn||void 0===zn?void 0:zn.id,_n.mutate(n,{onSettled:function(){Qn(!1),Bn(!1)}}))},onCancel:function(){Qn(!1)}})]}),(0,z.jsx)(X,{span:16,children:i&&(0,z.jsx)($,{placeholder:"Search",allowClear:!0,loading:un,onSearch:function(n){l(n)}})})]})}),A&&q&&an&&(0,z.jsx)(m.Z,{type:"error",message:an,closable:!0,banner:!0,onClose:function(){cn(),Q(!1)}}),tn&&(0,z.jsx)(m.Z,{type:"error",message:tn,closable:!0,banner:!0,onClose:function(){cn(),on(void 0)}}),(0,z.jsx)(p.Z,{spinning:sn||un,children:(0,z.jsx)(N,{onEdit:function(n){Nn(n),In(!0)},canEdit:t,canDelete:o,onDelete:function(n){Nn(n),Qn(!0)},data:dn,onChangePage:P,onChangePageSize:F,onChangeSort:h})})]})}},9593:function(n,e,t){t.d(e,{u:function(){return a}});var o=t(7892),i=t.n(o),r=t(3294),a=function(n,e,t){return function(n,e,t){var o=document.createElement("a");o.href=n,o.download="".concat(e,"-").concat(i()().format("YYYY-MM-DD"),".").concat(t),document.body.appendChild(o),o.click(),document.body.removeChild(o)}(t===r.Cx.EXCEL?window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"})):window.URL.createObjectURL(new Blob([n],{type:"application/json"})),e,t),!0}},2622:function(n,e,t){t.d(e,{Z:function(){return l}});var o=t(1413),i=t(2791),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},a=t(4291),c=function(n,e){return i.createElement(a.Z,(0,o.Z)((0,o.Z)({},n),{},{ref:e,icon:r}))};c.displayName="DeleteOutlined";var l=i.forwardRef(c)}}]);
//# sourceMappingURL=676.723d4e23.chunk.js.map